!function(){function a(){var a=$(this);a.hasClass("open")?a.find("ul").css("display","none"):a.find("ul").css("display","block"),a.toggleClass("open")}function t(){$(this).parent().find(".filename").html($(this).val())}$(document).delegate("li.submenu","click",a),$(document).delegate(".uploader input","change",t);var n=function(){var a=window.innerHeight;return"number"!=typeof a&&(a="CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight),a-41-36}();$("div.container").css("min-height",n+"px")}(),function(a){function t(a){this.options={container:"",template:"",url:"",data:{}},$.extend(this.options,a),this.$container=$(this.options.container)}var n={mix:function(a,t,n){for(var e in t)a[t]&&n||(a[t]=n[t]);return a},toArray:function(a,t){return[].slice.call(a,t||0)},cookie:function(a,t,n){var e,i,r;return arguments.length>1?(n=n||30,(null===t||void 0===t)&&(n=-1),"number"==typeof n&&(e=24*n*60*60*1e3,i=n=new Date,i.setTime(i.getTime()+e)),t=String(t),document.cookie=[encodeURIComponent(a),"=",encodeURIComponent(t),"; expires=",n.toGMTString(),"; path='/'"].join("")):(r=new RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?decodeURIComponent(r[1]):null}};a.util=n,t.prototype={init:function(a){this.getPage(a)},setData:function(a){$.extend(this.options.data,a)},template:function(a,t){var n=Handlebars.compile($(a).html());return n(t)},getPage:function(a){var t=this,n=a||1,e=t.options.url+n;$.ajax({type:"GET",url:e,dataType:"json",async:!0,data:t.options.data,success:function(a){if(null==a||null==a.items||0==a.items.length){t.$container.find(".page-data-list").html("");var n=t.$container.find(".pagination");n.html("");var e=t.$container.find(".datatable-info");return void e.html("共0条")}var i=a.items,r=a.pageinfo;t.$container.find(".page-data-list").html(t.template(t.options.template,i)),t.pagination(r)},error:function(){}})},pagination:function(a){var t=this;t.removePaginationHandle();var n=t.$container.find(".pagination"),e=t.$container.find(".datatable-info"),i=a.pagesize||10,r=(a.curpage-1)*i+1,o=a.curpage*i>=a.totalrows?a.totalrows:a.curpage*i;e.html("共"+a.totalrows+"条 当前展示第"+r+"条到第"+o+"条");for(var l=parseInt(a.curpage,10),c='<li  class="active"><a href="javascript:;"  data-page="'+l+'">'+l+" </a></li>",p=l-1,d=l+1,s="",g=parseInt(a.totalpage,10);p>l-4&&p>1;p--)c='<li><a href="javascript:;" data-page="'+p+'">'+p+"</a></li>"+c;for(1!=l&&(2==p?s='<li><a href="javascript:;"  data-page="2">2</a>':p>2&&(s='<li><a  href="javascript:;" class="blank">...</a></li>'),c='<li><a href="javascript:;"  data-page="1">1</a>'+s+c);l+4>d&&g>d;d++)c+='<li><a href="javascript:;" data-page="'+d+'">'+d+"</a></li>";l!=g&&(d==g-1?c+='<li><a href="javascript:;"  data-page="'+(g-1)+'">'+(g-1)+"</a>":g-1>d&&(c+='<li><a href="javascript:;" class="blank">...</a></li>'),c+='<li><a href="javascript:;"  data-page="'+a.totalpage+'">'+a.totalpage+" </a></li>"),n.html(c),n.data("curpage",a.curpage),n.data("totalpage",a.totalpage),t.addPaginationHandle(n)},addPaginationHandle:function(){var a=this,t=a.$container.find(".pagination");a.paginationHandle=function(t){t.preventDefault();var n=$(this),e=n.data("page");"pre"==e?a.prex():"next"==e?a.next():a.getPage(e)},t.delegate("a","click",a.paginationHandle)},removePaginationHandle:function(){var a=this;a.$container.find(".pagination").undelegate("a","click",a.paginationHandle)},prex:function(){var a=this,t=a.$container.find(".pagination"),n=t.data("curpage")||0;console.log(n),n=n-1>0?n-1:1,a.getPage(n)},next:function(){var a=this,t=a.$container.find(".pagination"),n=t.data("curpage")||0,e=t.data("totalpage")||0;n=n+1>e?e:n+1,a.getPage(n)},reloadPage:function(){var a=this,t=a.$container.find(".pagination"),n=t.data("curpage")||0;a.getPage(n)}},a.Page=t}(window),function(a){a.fn.extend({validate:function(){for(var t=a(this),n=t.find("input"),e=function(t,n){var e=null;0==(e=t.next(".help-inline")).length&&(e=a("<div class='help-inline'></div>"),t.after(e)),1==arguments.length?e.hide():(e.html(n),e.show())},i=0,r=n.length;r>i;i++){var o=n.eq(i),l=o.attr("type");if(-1!="text/email/url/password/phonenumber/".indexOf(l)){var c,p,d,s,g,u,f;if(p=o.attr("max"),d=o.attr("min"),s=o.attr("error")||"输入内容格式错误",g=o.attr("require"),u=o.attr("require_msg")||"不能为空",f=o.attr("patterns"),c=o.val(),0==a.trim(c).length&&(c=""),len=c.length,"require"==g||c){if("require"==g&&!c)return e(o,u),!1;if(d&&len<d)return e(o,s),!1;if(p&&len>p)return e(o,s),!1;if(f){var h=new RegExp(f);if(!h.exec(c))return e(o,s),!1}e(o)}}}return!0}})}(jQuery);